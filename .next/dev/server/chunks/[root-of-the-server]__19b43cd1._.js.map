{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///Users/apcrat/Documents/react/church_suit_business/affiliates/src/lib/db.js"],"sourcesContent":["import mysql from \"mysql2/promise\";\n\nexport const db = mysql.createPool({\n  host: process.env.DB_HOST,\n  user: process.env.DB_USER,\n  password: process.env.DB_PASSWORD,\n  database: process.env.DB_NAME,\n  port: Number(process.env.DB_PORT || 3306),\n  waitForConnections: true,\n  connectionLimit: 10,\n});"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,KAAK,8IAAK,CAAC,UAAU,CAAC;IACjC,MAAM,QAAQ,GAAG,CAAC,OAAO;IACzB,MAAM,QAAQ,GAAG,CAAC,OAAO;IACzB,UAAU,QAAQ,GAAG,CAAC,WAAW;IACjC,UAAU,QAAQ,GAAG,CAAC,OAAO;IAC7B,MAAM,OAAO,QAAQ,GAAG,CAAC,OAAO,IAAI;IACpC,oBAAoB;IACpB,iBAAiB;AACnB"}},
    {"offset": {"line": 131, "column": 0}, "map": {"version":3,"sources":["file:///Users/apcrat/Documents/react/church_suit_business/affiliates/src/lib/db-utils.js"],"sourcesContent":["import { clsx } from \"clsx\";\nimport { twMerge } from \"tailwind-merge\";\nimport crypto from \"crypto\";\nimport { serialize as phpSerialize } from \"php-serialize\";\n\n/**\n * shadcn utility: merges tailwind classes safely\n */\nexport function cn(...inputs) {\n  return twMerge(clsx(inputs));\n}\n\nexport function sha1(str) {\n  return crypto.createHash(\"sha1\").update(String(str)).digest(\"hex\");\n}\n\n// OpenCart-compatible 9-char salt\nexport function generateSalt() {\n  return crypto\n    .createHash(\"md5\")\n    .update(crypto.randomBytes(16).toString(\"hex\") + Date.now())\n    .digest(\"hex\")\n    .substring(0, 9);\n}\n\n// OpenCart hash: sha1(salt . sha1(salt . sha1(password)))\nexport function ocHashPassword(password, salt) {\n  return sha1(salt + sha1(salt + sha1(password)));\n}\n\nexport function ocVerifyPassword(inputPassword, storedSalt, storedHash) {\n  return ocHashPassword(inputPassword, storedSalt) === storedHash;\n}\n\n// OpenCart-style db escape (like $this->db->escape)\nexport function dbEscape(value) {\n  if (value === null || value === undefined) return \"\";\n  return String(value)\n    .replace(/\\\\/g, \"\\\\\\\\\")\n    .replace(/\\u0008/g, \"\\\\b\")\n    .replace(/\\t/g, \"\\\\t\")\n    .replace(/\\0/g, \"\\\\0\")\n    .replace(/\\n/g, \"\\\\n\")\n    .replace(/\\r/g, \"\\\\r\")\n    .replace(/\\u001a/g, \"\\\\Z\")\n    .replace(/\\x1a/g, \"\\\\Z\")\n    .replace(/'/g, \"\\\\'\")\n    .replace(/\"/g, '\\\\\"');\n}\n\n// Save only domain (remove https:// and www)\nexport function stripWebsite(url = \"\") {\n  return String(url)\n    .trim()\n    .replace(/^https?:\\/\\//i, \"\")\n    .replace(/^www\\./i, \"\")\n    .replace(/\\/+$/, \"\");\n}\n\nexport function isEmail(v) {\n  return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]{2,}$/.test(String(v || \"\").trim());\n}\n\nexport function isTenDigitPhone(v) {\n  return /^\\d{10}$/.test(String(v || \"\").trim());\n}\n\nexport function normalizeLogin(v) {\n  return String(v || \"\").trim();\n}\n\nexport function ocSerialize(value) {\n  return phpSerialize(value);\n}\n\nexport function isTruthy(v) {\n  return v === true || v === 1 || v === \"1\" || String(v).toLowerCase() === \"true\";\n}\n\nexport function getClientIp(req) {\n  if (!req?.headers) return \"127.0.0.1\";\n\n  // Proxy / Load balancer / Vercel\n  const xForwardedFor = req.headers.get(\"x-forwarded-for\");\n  if (xForwardedFor) {\n    // Can be: \"client, proxy1, proxy2\"\n    return xForwardedFor.split(\",\")[0].trim();\n  }\n\n  // Cloudflare\n  const cfIp = req.headers.get(\"cf-connecting-ip\");\n  if (cfIp) return cfIp;\n\n  // Fallback (local dev)\n  return \"127.0.0.1\";\n}\n\nexport function getFrontClientIp() {\n  const h = headers();\n\n  // Common proxy headers\n  const xff = h.get(\"x-forwarded-for\");\n  if (xff) return xff.split(\",\")[0].trim();\n\n  const realIp = h.get(\"x-real-ip\");\n  if (realIp) return realIp.trim();\n\n  // Fallback\n  return \"0.0.0.0\";\n}\n\nexport function money(v) {\n  const n = Number(v || 0);\n  return Number.isFinite(n) ? `$${n.toFixed(2)}` : \"$0.00\";\n}\n\nfunction parseDate(input) {\n  if (!input) return null;\n\n  // Already Date object\n  if (input instanceof Date) {\n    return isNaN(input.getTime()) ? null : input;\n  }\n\n  if (typeof input !== \"string\") return null;\n\n  // ISO or yyyy-mm-dd hh:mm:ss (MySQL)\n  if (/^\\d{4}-\\d{2}-\\d{2}/.test(input)) {\n    const d = new Date(input.replace(\" \", \"T\"));\n    return isNaN(d.getTime()) ? null : d;\n  }\n\n  // dd/mm/yyyy or dd/mm/yyyy hh:mm:ss\n  if (/^\\d{2}\\/\\d{2}\\/\\d{4}/.test(input)) {\n    const [datePart, timePart] = input.split(\" \");\n    const [dd, mm, yyyy] = datePart.split(\"/\");\n\n    const iso = `${yyyy}-${mm}-${dd}${timePart ? \"T\" + timePart : \"\"}`;\n    const d = new Date(iso);\n    return isNaN(d.getTime()) ? null : d;\n  }\n\n  // Fallback: let JS try\n  const d = new Date(input);\n  return isNaN(d.getTime()) ? null : d;\n}\n\n/**\n * Format date as MM/DD/YYYY (default)\n */\nexport function formatDate(input, format = \"MM/DD/YYYY\") {\n  const d = parseDate(input);\n\n  if (!d) return \"\";\n\n  const map = {\n    DD: String(d.getDate()).padStart(2, \"0\"),\n    MM: String(d.getMonth() + 1).padStart(2, \"0\"),\n    YYYY: d.getFullYear(),\n    HH: String(d.getHours()).padStart(2, \"0\"),\n    mm: String(d.getMinutes()).padStart(2, \"0\"),\n    ss: String(d.getSeconds()).padStart(2, \"0\"),\n  };\n\n  return format.replace(/DD|MM|YYYY|HH|mm|ss/g, (k) => map[k]);\n}"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAAA;;;;;AAKO,SAAS,GAAG,GAAG,MAAM;IAC1B,OAAO,IAAA,wKAAO,EAAC,IAAA,+IAAI,EAAC;AACtB;AAEO,SAAS,KAAK,GAAG;IACtB,OAAO,gHAAM,CAAC,UAAU,CAAC,QAAQ,MAAM,CAAC,OAAO,MAAM,MAAM,CAAC;AAC9D;AAGO,SAAS;IACd,OAAO,gHAAM,CACV,UAAU,CAAC,OACX,MAAM,CAAC,gHAAM,CAAC,WAAW,CAAC,IAAI,QAAQ,CAAC,SAAS,KAAK,GAAG,IACxD,MAAM,CAAC,OACP,SAAS,CAAC,GAAG;AAClB;AAGO,SAAS,eAAe,QAAQ,EAAE,IAAI;IAC3C,OAAO,KAAK,OAAO,KAAK,OAAO,KAAK;AACtC;AAEO,SAAS,iBAAiB,aAAa,EAAE,UAAU,EAAE,UAAU;IACpE,OAAO,eAAe,eAAe,gBAAgB;AACvD;AAGO,SAAS,SAAS,KAAK;IAC5B,IAAI,UAAU,QAAQ,UAAU,WAAW,OAAO;IAClD,OAAO,OAAO,OACX,OAAO,CAAC,OAAO,QACf,OAAO,CAAC,WAAW,OACnB,OAAO,CAAC,OAAO,OACf,OAAO,CAAC,OAAO,OACf,OAAO,CAAC,OAAO,OACf,OAAO,CAAC,OAAO,OACf,OAAO,CAAC,WAAW,OACnB,OAAO,CAAC,SAAS,OACjB,OAAO,CAAC,MAAM,OACd,OAAO,CAAC,MAAM;AACnB;AAGO,SAAS,aAAa,MAAM,EAAE;IACnC,OAAO,OAAO,KACX,IAAI,GACJ,OAAO,CAAC,iBAAiB,IACzB,OAAO,CAAC,WAAW,IACnB,OAAO,CAAC,QAAQ;AACrB;AAEO,SAAS,QAAQ,CAAC;IACvB,OAAO,gCAAgC,IAAI,CAAC,OAAO,KAAK,IAAI,IAAI;AAClE;AAEO,SAAS,gBAAgB,CAAC;IAC/B,OAAO,WAAW,IAAI,CAAC,OAAO,KAAK,IAAI,IAAI;AAC7C;AAEO,SAAS,eAAe,CAAC;IAC9B,OAAO,OAAO,KAAK,IAAI,IAAI;AAC7B;AAEO,SAAS,YAAY,KAAK;IAC/B,OAAO,IAAA,kNAAY,EAAC;AACtB;AAEO,SAAS,SAAS,CAAC;IACxB,OAAO,MAAM,QAAQ,MAAM,KAAK,MAAM,OAAO,OAAO,GAAG,WAAW,OAAO;AAC3E;AAEO,SAAS,YAAY,GAAG;IAC7B,IAAI,CAAC,KAAK,SAAS,OAAO;IAE1B,iCAAiC;IACjC,MAAM,gBAAgB,IAAI,OAAO,CAAC,GAAG,CAAC;IACtC,IAAI,eAAe;QACjB,mCAAmC;QACnC,OAAO,cAAc,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI;IACzC;IAEA,aAAa;IACb,MAAM,OAAO,IAAI,OAAO,CAAC,GAAG,CAAC;IAC7B,IAAI,MAAM,OAAO;IAEjB,uBAAuB;IACvB,OAAO;AACT;AAEO,SAAS;IACd,MAAM,IAAI;IAEV,uBAAuB;IACvB,MAAM,MAAM,EAAE,GAAG,CAAC;IAClB,IAAI,KAAK,OAAO,IAAI,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI;IAEtC,MAAM,SAAS,EAAE,GAAG,CAAC;IACrB,IAAI,QAAQ,OAAO,OAAO,IAAI;IAE9B,WAAW;IACX,OAAO;AACT;AAEO,SAAS,MAAM,CAAC;IACrB,MAAM,IAAI,OAAO,KAAK;IACtB,OAAO,OAAO,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,OAAO,CAAC,IAAI,GAAG;AACnD;AAEA,SAAS,UAAU,KAAK;IACtB,IAAI,CAAC,OAAO,OAAO;IAEnB,sBAAsB;IACtB,IAAI,iBAAiB,MAAM;QACzB,OAAO,MAAM,MAAM,OAAO,MAAM,OAAO;IACzC;IAEA,IAAI,OAAO,UAAU,UAAU,OAAO;IAEtC,qCAAqC;IACrC,IAAI,qBAAqB,IAAI,CAAC,QAAQ;QACpC,MAAM,IAAI,IAAI,KAAK,MAAM,OAAO,CAAC,KAAK;QACtC,OAAO,MAAM,EAAE,OAAO,MAAM,OAAO;IACrC;IAEA,oCAAoC;IACpC,IAAI,uBAAuB,IAAI,CAAC,QAAQ;QACtC,MAAM,CAAC,UAAU,SAAS,GAAG,MAAM,KAAK,CAAC;QACzC,MAAM,CAAC,IAAI,IAAI,KAAK,GAAG,SAAS,KAAK,CAAC;QAEtC,MAAM,MAAM,GAAG,KAAK,CAAC,EAAE,GAAG,CAAC,EAAE,KAAK,WAAW,MAAM,WAAW,IAAI;QAClE,MAAM,IAAI,IAAI,KAAK;QACnB,OAAO,MAAM,EAAE,OAAO,MAAM,OAAO;IACrC;IAEA,uBAAuB;IACvB,MAAM,IAAI,IAAI,KAAK;IACnB,OAAO,MAAM,EAAE,OAAO,MAAM,OAAO;AACrC;AAKO,SAAS,WAAW,KAAK,EAAE,SAAS,YAAY;IACrD,MAAM,IAAI,UAAU;IAEpB,IAAI,CAAC,GAAG,OAAO;IAEf,MAAM,MAAM;QACV,IAAI,OAAO,EAAE,OAAO,IAAI,QAAQ,CAAC,GAAG;QACpC,IAAI,OAAO,EAAE,QAAQ,KAAK,GAAG,QAAQ,CAAC,GAAG;QACzC,MAAM,EAAE,WAAW;QACnB,IAAI,OAAO,EAAE,QAAQ,IAAI,QAAQ,CAAC,GAAG;QACrC,IAAI,OAAO,EAAE,UAAU,IAAI,QAAQ,CAAC,GAAG;QACvC,IAAI,OAAO,EAAE,UAAU,IAAI,QAAQ,CAAC,GAAG;IACzC;IAEA,OAAO,OAAO,OAAO,CAAC,wBAAwB,CAAC,IAAM,GAAG,CAAC,EAAE;AAC7D"}},
    {"offset": {"line": 280, "column": 0}, "map": {"version":3,"sources":["file:///Users/apcrat/Documents/react/church_suit_business/affiliates/src/app/api/affiliate/register/route.js"],"sourcesContent":["import { db } from \"@/lib/db\";\nimport {\n  generateSalt,\n  ocHashPassword,\n  dbEscape,\n  stripWebsite,\n  isEmail,\n  isTenDigitPhone,\n  ocSerialize,\n  isTruthy,\n  getClientIp,\n} from \"@/lib/db-utils\";\n\n/**\n * INSERT INTO affiliate_extension (OpenCart style)\n */\nasync function installModule(type, code, affiliate_id) {\n  const sql = `\n    INSERT INTO affiliate_extension SET\n      affiliate_id='${Number(affiliate_id)}',\n      \\`type\\`='${dbEscape(type)}',\n      \\`code\\`='${dbEscape(code)}'\n  `;\n  const [res] = await db.query(sql);\n  return res.insertId;\n}\n\n/**\n * INSERT affiliate settings (OpenCart style)\n * - Deletes existing entries for affiliate+code\n * - Inserts each key/value pair\n */\nasync function addAffiliateSettings(code, data, affiliate_id = 0) {\n  await db.query(`\n    DELETE FROM affiliate_setting\n    WHERE affiliate_id='${Number(affiliate_id)}'\n      AND \\`code\\`='${dbEscape(code)}'\n  `);\n\n  for (const [key, value] of Object.entries(data || {})) {\n    if (!String(key).startsWith(code)) continue;\n\n    if (value === null || value === undefined || typeof value !== \"object\") {\n      await db.query(`\n        INSERT INTO affiliate_setting SET\n          affiliate_id='${Number(affiliate_id)}',\n          \\`code\\`='${dbEscape(code)}',\n          \\`key\\`='${dbEscape(key)}',\n          \\`value\\`='${dbEscape(value)}',\n          serialized='0'\n      `);\n    } else {\n      const serialized = ocSerialize(value);\n\n      await db.query(`\n        INSERT INTO affiliate_setting SET\n          affiliate_id='${Number(affiliate_id)}',\n          \\`code\\`='${dbEscape(code)}',\n          \\`key\\`='${dbEscape(key)}',\n          \\`value\\`='${dbEscape(serialized)}',\n          serialized='1'\n      `);\n    }\n  }\n}\n\nasync function getAffiliateBasicSettings() {\n  const sql = `SELECT \\`key\\`, \\`value\\` FROM affiliate_basic_setting WHERE \\`code\\`='affiliate_basic'`;\n  const [rows] = await db.query(sql);\n\n  if (!rows || rows.length === 0) return {};\n\n  const settings = {};\n  for (const row of rows) settings[row.key] = row.value;\n  return settings;\n}\n\nasync function addAffiliateCategory(affiliate_id) {\n  const categories = [];\n\n  for (let i = 0; i < 2; i++) {\n    const name = `Category ${i + 1}`;\n\n    const sql = `\n      INSERT INTO category SET\n      category_old_id=0,\n      category_child_old_id=0,\n      affiliate_id='${Number(affiliate_id)}',\n      name='${dbEscape(name)}',\n      name_affiliate='',\n      description='Category',\n      meta_title='Category',\n      meta_description='Category',\n      meta_keyword='Category',\n      shopify_tag='',\n      export_product_to_shopify=0,\n      is_shopify_product_update_forcefully=0,\n      dcs_brief='',\n      dcs_detail='',\n      dcs_short='',\n      is_description_mobile=0,\n      is_not_for_wholesale=0,\n      is_not_for_affiliate=0,\n      image='',\n      image_path='',\n      image_affiliate='',\n      folder_name='',\n      parent_id=0,\n      top=1,\n      is_catalog=0,\n      is_special=0,\n      is_women=0,\n      is_men=0,\n      is_accessories=0,\n      \\`column\\`=0,\n      sort_order='${i + 1}',\n      status=1,\n      date_added=NOW(),\n      date_modified=NOW()\n    `;\n\n    const [res] = await db.query(sql);\n    const category_id = res.insertId;\n\n    categories.push(category_id);\n\n    await db.query(`\n      INSERT INTO category_path SET\n        category_id='${Number(category_id)}',\n        path_id='${Number(category_id)}',\n        level='0'\n    `);\n  }\n\n  return categories;\n}\n\nasync function addAffiliateProducts(affiliate_id, categories = []) {\n  const products = [];\n\n  for (let i = 0; i < 4; i++) {\n    const name = `Product ${i + 1}`;\n\n    const sql = `\n      INSERT INTO product SET\n        product_old_id=0,\n        affiliate_id='${Number(affiliate_id)}',\n        name='${dbEscape(name)}',\n        description='${dbEscape(name)}',\n        meta_title='${dbEscape(name)}',\n        meta_description='${dbEscape(name)}',\n        meta_keyword='${dbEscape(name)}',\n        model='',\n        sku='',\n        upc='',\n        ean='',\n        jan='',\n        isbn='',\n        mpn='',\n        location='',\n        quantity='1000',\n        stock_status_id=0,\n        image='affiliate_images/demo-product.jpg',\n        image_path='',\n        file_name='',\n        is_large_image_found=0,\n        is_image_background_is_white=0,\n        video='',\n        manufacturer_id=0,\n        brand_id=0,\n        shipping=1,\n        price='100',\n        price_retail='125',\n        price_original='150',\n        is_men=0,\n        points=0,\n        tax_class_id=0,\n        date_available=NOW(),\n        weight='0.000',\n        weight_class_id=0,\n        length='0.000',\n        width='0.000',\n        height='0.000',\n        length_class_id=0,\n        subtract=0,\n        minimum='1',\n        sort_order='${i + 1}',\n        status='1',\n        viewed=0,\n        is_product_modified=0,\n        is_web_scrape_product_verify=0,\n        date_added=NOW(),\n        date_modified=NOW()\n    `;\n\n    const [res] = await db.query(sql);\n    const product_id = res.insertId;\n\n    products.push(product_id);\n\n    if (categories && categories.length) {\n      for (const category_id of categories) {\n        await db.query(`\n          INSERT INTO product_to_category SET\n            product_id='${Number(product_id)}',\n            category_id='${Number(category_id)}'\n        `);\n      }\n    }\n  }\n\n  return products;\n}\n\nasync function addAffiliatePages(affiliate_id, pages = []) {\n  for (const page of pages) {\n    const sql = `\n      INSERT INTO information SET\n        affiliate_id='${Number(affiliate_id)}',\n        title='${dbEscape(page.name)}',\n        description='${dbEscape(page.description)}',\n        description_top='',\n        short='',\n        meta_title='${dbEscape(page.meta_title)}',\n        meta_description='${dbEscape(page.meta_description)}',\n        meta_keyword='',\n        image='',\n        image_mobile='',\n        top='0',\n        bottom='1',\n        affiliate=0,\n        catalog='',\n        trending_product_title='',\n        trending_product_status=0,\n        trending_categories='',\n        sort_order='${Number(page.sort_order || 0)}',\n        status='${Number(page.status || 0)}'\n    `;\n    await db.query(sql);\n  }\n}\n\nasync function addLargeBanners(affiliate_id) {\n  const sliders = {\n    code: \"slideshow\",\n    module_name: \"Home Page Slideshow\",\n    width: \"1900\",\n    height: \"700\",\n    sort_order: \"1\",\n    status: \"1\",\n    slideshow_images: [\n      { title: \"First\", link: \"index.php?route=product/catalog\", image: \"catalog/banner/1.jpg\", sort_order: 1 },\n      { title: \"Second\", link: \"index.php?route=product/catalog\", image: \"catalog/banner/2.jpg\", sort_order: 2 },\n    ],\n  };\n\n  const settings = ocSerialize(sliders);\n\n  const sql = `\n    INSERT INTO page_builder SET\n      affiliate_id='${Number(affiliate_id)}',\n      page_id=0,\n      module_name='${dbEscape(sliders.module_name)}',\n      \\`code\\`='${dbEscape(sliders.code)}',\n      \\`setting\\`='${dbEscape(settings)}',\n      location_type=0,\n      sort_order='${Number(sliders.sort_order)}',\n      status='${Number(sliders.status)}',\n      date_added=NOW(),\n      date_modified=NOW(),\n      user_added=0,\n      user_modified=0,\n      is_delete=0\n  `;\n  await db.query(sql);\n}\n\nasync function addSmallBanners(affiliate_id) {\n  const banners = {\n    code: \"banner\",\n    module_name: \"Home Page Banners\",\n    width: \"380\",\n    height: \"270\",\n    sort_order: \"2\",\n    status: \"1\",\n    banner_images: [\n      { title: \"Womens\", link: \"index.php?route=product/womens\", image: \"catalog/banner-small/1.jpg\", sort_order: 1 },\n      { title: \"Mens\", link: \"index.php?route=product/mens\", image: \"catalog/banner-small/2.jpg\", sort_order: 2 },\n      { title: \"Accessories\", link: \"index.php?route=product/accessories\", image: \"catalog/banner-small/3.jpg\", sort_order: 3 },\n    ],\n  };\n\n  const settings = ocSerialize(banners);\n\n  const sql = `\n    INSERT INTO page_builder SET\n      affiliate_id='${Number(affiliate_id)}',\n      page_id=0,\n      module_name='${dbEscape(banners.module_name)}',\n      \\`code\\`='${dbEscape(banners.code)}',\n      \\`setting\\`='${dbEscape(settings)}',\n      location_type=0,\n      sort_order='${Number(banners.sort_order)}',\n      status='${Number(banners.status)}',\n      date_added=NOW(),\n      date_modified=NOW(),\n      user_added=0,\n      user_modified=0,\n      is_delete=0\n  `;\n  await db.query(sql);\n}\n\nasync function getChildCategories(parent_id) {\n  const sql = `\n    SELECT category_id\n    FROM category\n    WHERE parent_id='${Number(parent_id)}' AND status=1\n    ORDER BY sort_order ASC, category_id ASC\n  `;\n  const [rows] = await db.query(sql);\n  return (rows || []).map((r) => Number(r.category_id));\n}\n\nfunction pickRandom(arr = []) {\n  if (!arr.length) return null;\n  const idx = Math.floor(Math.random() * arr.length);\n  return arr[idx];\n}\n\nasync function addCategoryProductsModule(affiliate_id) {\n  const women_categories = await getChildCategories(1);\n  const accessaries_category = await getChildCategories(434);\n  const men_categories = await getChildCategories(493);\n\n  const selectedWomen = pickRandom(women_categories);\n  const selectedAccessories = pickRandom(accessaries_category);\n  const selectedMen = pickRandom(men_categories);\n\n  const category_product_module = {\n    code: \"category_product_module\",\n    module_name: \"Latest Category Products\",\n    category: \"\",\n    categories: [],\n    limit: 4,\n    width: 200,\n    height: 200,\n    sort_order: 3,\n    status: 1,\n  };\n\n  if (selectedWomen) category_product_module.categories.push(selectedWomen);\n  if (selectedAccessories) category_product_module.categories.push(selectedAccessories);\n  if (selectedMen) category_product_module.categories.push(selectedMen);\n\n  const setting = ocSerialize(category_product_module);\n\n  const sql = `\n    INSERT INTO page_builder SET\n      affiliate_id='${Number(affiliate_id)}',\n      page_id=0,\n      module_name='${dbEscape(category_product_module.module_name)}',\n      \\`code\\`='${dbEscape(category_product_module.code)}',\n      \\`setting\\`='${dbEscape(setting)}',\n      location_type=0,\n      sort_order='${Number(category_product_module.sort_order)}',\n      status='${Number(category_product_module.status)}',\n      date_added=NOW(),\n      date_modified=NOW(),\n      user_added=0,\n      user_modified=0,\n      is_delete=0\n  `;\n  await db.query(sql);\n}\n\n/** helper: check affiliate exists */\nasync function getAffiliateById(affiliate_id) {\n  const affId = Number(affiliate_id);\n  if (!affId) return null;\n  const [rows] = await db.query(`SELECT * FROM affiliate WHERE affiliate_id=${affId} LIMIT 1`);\n  return rows?.[0] || null;\n}\n\n/** helper: safe placeholder store name */\nfunction makeTempStoreName() {\n  return `TEMP-${Date.now()}`;\n}\n\nasync function godaddyCheckDomain(domainRaw) {\n  const json = {};\n\n  const domain_name = String(domainRaw || \"\")\n    .trim()\n    .replace(/^https?:\\/\\//i, \"\")\n    .replace(/^www\\./i, \"\");\n\n  // Validate like PHP (domain url must be valid)\n  const domainOk = /^[a-z0-9.-]+\\.[a-z]{2,}$/i.test(domain_name);\n  if (!domainOk) {\n    json.error = \"Warning: Please enter valid URL!\";\n    return json;\n  }\n\n  const API_KEY = process.env.GODADDY_API_KEY;\n  const API_SECRET = process.env.GODADDY_API_SECRET;\n  const BASE_URL = process.env.GODADDY_BASE_URL || \"https://api.godaddy.com\";\n\n  if (!API_KEY || !API_SECRET) {\n    json.error = \"GoDaddy API credentials missing\";\n    return json;\n  }\n\n  const header = {\n    Authorization: `sso-key ${API_KEY}:${API_SECRET}`,\n    \"Content-Type\": \"application/json\",\n  };\n\n  // 1) availability\n  const url = `${BASE_URL}/v1/domains/available?domain=${encodeURIComponent(domain_name)}&checkType=FAST&forTransfer=false`;\n\n  const res = await fetch(url, { method: \"GET\", headers: header, cache: \"no-store\" });\n  const final_result = await res.json().catch(() => ({}));\n\n  // Similar to your PHP check\n  if (final_result?.code === \"ACCESS_DENIED\") {\n    json.error = \"GoDaddy ACCESS_DENIED\";\n    return json;\n  }\n\n  if (final_result?.available === true) {\n    json.success = true;\n    json.domain_found = \"Congratulation, domain available!\";\n    return json;\n  }\n\n  // Not available → suggestions\n  json.error = \"Warning: Domain not available!\";\n  json.domain_not_available = true;\n\n  // suggestion query: first token before dot (like PHP)\n  const base = domain_name.replace(/^www\\./i, \"\");\n  const parts = base.split(\".\");\n  const keyword = parts[0] || base;\n\n  const suggestUrl =\n    `${BASE_URL}/v1/domains/suggest?query=${encodeURIComponent(keyword)}` +\n    `&sources=keywordspin&waitMs=1000`;\n\n  const sres = await fetch(suggestUrl, { method: \"GET\", headers: header, cache: \"no-store\" });\n  const suggestions = await sres.json().catch(() => []);\n\n  if (Array.isArray(suggestions) && suggestions.length > 0) {\n    const list = [];\n    for (const item of suggestions) {\n      const d = item?.domain;\n      if (typeof d === \"string\" && d.toLowerCase().endsWith(\".com\")) {\n        list.push(d);\n      }\n    }\n    if (list.length) json.domain_suggestions = list;\n  }\n\n  return json;\n}\n\nexport async function POST(req) {\n  const body = await req.json().catch(() => ({}));\n\n  // domain availability action (NO new route)\n  if (String(body?.action || \"\") === \"check_domain\") {\n    const domain_name = body?.domain_name || \"\";\n    const result = await godaddyCheckDomain(domain_name);\n    return Response.json(result);\n  }\n\n  const step = Number(body.step || 0);\n\n  if (![1, 2, 3].includes(step)) {\n    return Response.json({ message: \"step is required (1,2,3)\" }, { status: 400 });\n  }\n\n  // shared\n  const ip = getClientIp(req);\n\n  // ------------------------------------------------------------\n  // STEP 1: create OR update affiliate with personal info only\n  // ------------------------------------------------------------\n  if (step === 1) {\n    const firstname = dbEscape(body.firstname);\n    const lastname = dbEscape(body.lastname);\n    const email = dbEscape(body.email).toLowerCase();\n    const telephone = dbEscape(body.telephone);\n\n    const incomingAffiliateId = Number(body?.affiliate_id || 0) || 0;\n\n    // validations (only personal)\n    if (!firstname) return Response.json({ message: \"firstname is required\" }, { status: 400 });\n    if (firstname.length < 1 || firstname.length > 32) {\n      return Response.json({ message: \"First name must be between 1 to 32 characters\" }, { status: 400 });\n    }\n\n    if (!lastname) return Response.json({ message: \"lastname is required\" }, { status: 400 });\n    if (lastname.length < 1 || lastname.length > 32) {\n      return Response.json({ message: \"Last name must be between 1 to 32 characters\" }, { status: 400 });\n    }\n\n    if (!email) return Response.json({ message: \"email is required\" }, { status: 400 });\n    if (!isEmail(email)) {\n      return Response.json({ message: \"Please enter a valid email address\" }, { status: 400 });\n    }\n\n    if (!telephone) return Response.json({ message: \"telephone is required\" }, { status: 400 });\n    if (!isTenDigitPhone(telephone)) {\n      return Response.json({ message: \"Phone/Mobile must be exactly 10 digits (numbers only)\" }, { status: 400 });\n    }\n\n    // ✅ uniqueness checks (ignore self if updating)\n    const notSelf = incomingAffiliateId ? `AND affiliate_id <> ${incomingAffiliateId}` : \"\";\n\n    const [emailRows] = await db.query(`\n      SELECT affiliate_id\n      FROM affiliate\n      WHERE LOWER(email)=LOWER('${dbEscape(email)}')\n      ${notSelf}\n      LIMIT 1\n    `);\n    if (emailRows?.length) {\n      return Response.json({ message: \"Email already exists\" }, { status: 409 });\n    }\n\n    const [telRows] = await db.query(`\n      SELECT affiliate_id\n      FROM affiliate\n      WHERE telephone='${dbEscape(telephone)}'\n      ${notSelf}\n      LIMIT 1\n    `);\n    if (telRows?.length) {\n      return Response.json({ message: \"Phone/Mobile already exists\" }, { status: 409 });\n    }\n\n    // ✅ If affiliate_id provided and exists -> UPDATE (do NOT insert again)\n    if (incomingAffiliateId) {\n      const existing = await getAffiliateById(incomingAffiliateId);\n      if (existing) {\n        await db.query(`\n          UPDATE affiliate SET\n            firstname='${firstname}',\n            lastname='${lastname}',\n            email='${email}',\n            telephone='${telephone}',\n            ip='${dbEscape(ip)}',\n            date_modified=NOW()\n          WHERE affiliate_id=${incomingAffiliateId}\n          LIMIT 1\n        `);\n\n        return Response.json({ success: true, step: 1, affiliate_id: incomingAffiliateId, mode: \"updated\" });\n      }\n    }\n\n    // ✅ Otherwise create minimal row (insert)\n    const tempStore = makeTempStoreName();\n\n    // set a temporary password hash (will be overwritten in step3)\n    const salt = generateSalt();\n    const tmpPwd = `tmp-${Date.now()}-${Math.random().toString(16).slice(2)}`;\n    const hashPassword = ocHashPassword(tmpPwd, salt);\n\n    const affiliateSql = `\n      INSERT INTO affiliate SET\n        affiliate_type='0',\n        fees='0',\n        store_name='${dbEscape(tempStore)}',\n        firstname='${firstname}',\n        lastname='${lastname}',\n        email='${email}',\n        from_email='',\n        telephone='${telephone}',\n        fax='',\n        password='${dbEscape(hashPassword)}',\n        salt='${dbEscape(salt)}',\n        company='',\n        website='',\n        address_1='',\n        address_2='',\n        city='',\n        postcode='',\n        country_id='0',\n        zone_id='0',\n        code='',\n        is_customer_own_domain='0',\n        is_domain_available='0',\n        stripe_token='',\n        stripe_customer_id='',\n        stripe_plan_id='',\n        recurring_billing='0',\n        recurring_billing_id='0',\n        start_date=NOW(),\n        end_date=NOW(),\n        store_category_type='0',\n        commission='0',\n        tax='',\n        payment='',\n        cheque='',\n        paypal='',\n        bank_name='',\n        bank_branch_number='',\n        bank_swift_code='',\n        bank_account_name='',\n        bank_account_number='',\n        ip='${dbEscape(ip)}',\n        status='0',\n        newsletter='1',\n        newsletter_text='0',\n        affiliate_status_id='15',\n        approved='0',\n        stop_automation='0',\n        user_added='0',\n        user_modified='0',\n        date_added=NOW(),\n        date_modified=NOW(),\n        date_update=NOW(),\n        is_delete='0'\n    `;\n\n    const [result] = await db.query(affiliateSql);\n    const affiliate_id = result.insertId;\n\n    return Response.json({ success: true, step: 1, affiliate_id, mode: \"inserted\" });\n  }\n\n  // ------------------------------------------------------------\n  // STEP 2: update plan + business info\n  // ------------------------------------------------------------\n  if (step === 2) {\n    const affiliate_id = Number(body.affiliate_id || 0);\n    if (!affiliate_id) return Response.json({ message: \"affiliate_id is required\" }, { status: 400 });\n\n    const affiliate = await getAffiliateById(affiliate_id);\n    if (!affiliate) return Response.json({ message: \"Affiliate not found\" }, { status: 404 });\n\n    const affiliate_plan_id = Number(body.affiliate_plan_id || 0);\n    const fees = Number(body.fees || 0);\n    const business_name = dbEscape(body.business_name);\n    const website_domain = stripWebsite(body.website || \"\");\n    const website = dbEscape(website_domain);\n\n    const stripe_plan_id = dbEscape(body.stripe_plan_id || \"\");\n\n    const price_schema = Number(body.price_schema || 0);\n    const default_markup = Number(body.default_markup || 0);\n    const retail_price_commission = Number(body.retail_price_commission || 0);\n    const is_catalog_access = body.is_catalog_access;\n\n    // validations step2\n    if (!affiliate_plan_id) {\n      return Response.json({ message: \"affiliate_plan_id is required\" }, { status: 400 });\n    }\n\n    if (!business_name) {\n      return Response.json({ message: \"business_name is required\" }, { status: 400 });\n    }\n    if (business_name.length < 3 || business_name.length > 32) {\n      return Response.json({ message: \"Business name must be between 3 to 32 characters\" }, { status: 400 });\n    }\n\n    // website optional but validate if present\n    if (website_domain) {\n      const domainOk = /^[a-z0-9.-]+\\.[a-z]{2,}$/i.test(website_domain);\n      if (!domainOk) {\n        return Response.json({ message: \"Website must be a valid domain like example.com\" }, { status: 400 });\n      }\n    }\n\n    // uniqueness checks for business_name + website (email/tel already done in step1)\n    const [bizRows] = await db.query(\n      `SELECT affiliate_id FROM affiliate WHERE LOWER(store_name)=LOWER('${dbEscape(business_name)}') AND affiliate_id<>${affiliate_id} LIMIT 1`\n    );\n    if (bizRows?.length) return Response.json({ message: \"Business name already exists\" }, { status: 409 });\n\n    if (website_domain) {\n      const [webRows] = await db.query(\n        `SELECT affiliate_id FROM affiliate WHERE LOWER(website)=LOWER('${dbEscape(website_domain)}') AND affiliate_id<>${affiliate_id} LIMIT 1`\n      );\n      if (webRows?.length) return Response.json({ message: \"Website already exists\" }, { status: 409 });\n    }\n\n    // update\n    await db.query(`\n      UPDATE affiliate SET\n        affiliate_type='${affiliate_plan_id}',\n        fees='${fees}',\n        store_name='${business_name}',\n        website='${website}',\n        stripe_plan_id='${stripe_plan_id}',\n        date_modified=NOW(),\n        ip='${dbEscape(ip)}'\n      WHERE affiliate_id=${affiliate_id}\n    `);\n\n    // NOTE:\n    // price_schema/default_markup/retail_price_commission/is_catalog_access are used later in step3 settings/demo creation.\n    // We keep them in memory from request (client sends again in step3 OR you can store them in affiliate table if you have columns).\n    // For now: client should resend them in step3 as well OR you can store them somewhere.\n    // We will REQUIRE step3 request to include these values again (same as your previous single-step flow).\n\n    return Response.json({ success: true, step: 2, affiliate_id });\n  }\n\n  // ------------------------------------------------------------\n  // STEP 3: update address + password + terms, then run FULL setup\n  // ------------------------------------------------------------\n  if (step === 3) {\n    const affiliate_id = Number(body.affiliate_id || 0);\n    if (!affiliate_id) return Response.json({ message: \"affiliate_id is required\" }, { status: 400 });\n\n    const affiliate = await getAffiliateById(affiliate_id);\n    if (!affiliate) return Response.json({ message: \"Affiliate not found\" }, { status: 404 });\n\n    const address_1 = dbEscape(body.address_1);\n    const address_2 = dbEscape(body.address_2 || \"\");\n    const city = dbEscape(body.city);\n    const postcode = dbEscape(body.postcode);\n    const country_id = Number(body.country_id || 0);\n    const zone_id = Number(body.zone_id || 0);\n\n    const password = dbEscape(body.password ?? \"\");\n    const confirm = dbEscape(body.confirm ?? \"\");\n\n    const agree =\n      body.agree_terms === true ||\n      body.agree_terms === \"true\" ||\n      body.agree_terms === \"1\" ||\n      body.agree_terms === 1;\n\n    // validations step3\n    if (!address_1) return Response.json({ message: \"address_1 is required\" }, { status: 400 });\n    if (!city) return Response.json({ message: \"city is required\" }, { status: 400 });\n    if (!country_id) return Response.json({ message: \"country_id is required\" }, { status: 400 });\n    if (!zone_id) return Response.json({ message: \"zone_id is required\" }, { status: 400 });\n\n    if (!password) return Response.json({ message: \"password is required\" }, { status: 400 });\n    if (password.length < 6 || password.length > 20) {\n      return Response.json({ message: \"Password must be between 6 to 20 characters\" }, { status: 400 });\n    }\n    if (password !== confirm) {\n      return Response.json({ message: \"Passwords do not match\" }, { status: 400 });\n    }\n    if (!agree) {\n      return Response.json({ message: \"You must agree to the Terms & Conditions\" }, { status: 400 });\n    }\n\n    // these must be present for your original setup logic\n    const price_schema = Number(body.price_schema || 0);\n    const default_markup = Number(body.default_markup || 0);\n    const retail_price_commission = Number(body.retail_price_commission || 0);\n    const is_catalog_access = body.is_catalog_access;\n\n    // set real password now\n    const salt = generateSalt();\n    const hashPassword = ocHashPassword(password, salt);\n\n    await db.query(`\n      UPDATE affiliate SET\n        affiliate_status_id='1',\n        address_1='${address_1}',\n        address_2='${address_2}',\n        city='${city}',\n        postcode='${postcode}',\n        country_id='${country_id}',\n        zone_id='${zone_id}',\n        password='${dbEscape(hashPassword)}',\n        salt='${dbEscape(salt)}',\n        date_modified=NOW(),\n        ip='${dbEscape(ip)}'\n      WHERE affiliate_id=${affiliate_id}\n    `);\n\n    // Reload latest affiliate after step3 update\n    const aff = await getAffiliateById(affiliate_id);\n\n    // --------------------------------------------\n    // NOW RUN YOUR ORIGINAL \"heavy\" setup\n    // --------------------------------------------\n    const firstname = dbEscape(aff.firstname || \"\");\n    const lastname = dbEscape(aff.lastname || \"\");\n    const email = dbEscape(String(aff.email || \"\")).toLowerCase();\n    const telephone = dbEscape(aff.telephone || \"\");\n    const business_name = dbEscape(aff.store_name || \"\");\n    const website = dbEscape(aff.website || \"\");\n\n    // 1) Create affiliate_user\n    const username = email;\n\n    const affiliateUserQuery = `INSERT INTO affiliate_user SET\n      affiliate_id='${affiliate_id}',\n      username='${username}',\n      password='${dbEscape(hashPassword)}',\n      salt='${dbEscape(salt)}',\n      firstname='${firstname}',\n      lastname='${lastname}',\n      email='${email}',\n      telephone='${telephone}',\n      image='',\n      code='',\n      ip='${dbEscape(ip)}',\n      status='0',\n      user_added='0',\n      date_added=NOW(),\n      date_modified=NOW(),\n      is_delete=0\n    `;\n\n    await db.query(affiliateUserQuery);\n\n    // 2) Install totals/modules\n    await installModule(\"total\", \"sub_total\", affiliate_id);\n    await addAffiliateSettings(\n      \"affiliate_sub_total\",\n      { affiliate_sub_total_status: \"1\", affiliate_sub_total_sort_order: \"1\" },\n      affiliate_id\n    );\n\n    await installModule(\"total\", \"shipping\", affiliate_id);\n    await addAffiliateSettings(\n      \"affiliate_shipping\",\n      { affiliate_shipping_status: \"2\", affiliate_shipping_sort_order: \"10\" },\n      affiliate_id\n    );\n\n    await installModule(\"total\", \"coupon\", affiliate_id);\n    await addAffiliateSettings(\n      \"affiliate_coupon\",\n      { affiliate_coupon_status: \"1\", affiliate_coupon_sort_order: \"3\" },\n      affiliate_id\n    );\n\n    await installModule(\"total\", \"credit\", affiliate_id);\n    await addAffiliateSettings(\n      \"affiliate_credit\",\n      { affiliate_credit_status: \"1\", affiliate_credit_sort_order: \"4\" },\n      affiliate_id\n    );\n\n    await installModule(\"total\", \"reward\", affiliate_id);\n    await addAffiliateSettings(\n      \"affiliate_reward\",\n      { affiliate_reward_status: \"1\", affiliate_reward_sort_order: \"5\" },\n      affiliate_id\n    );\n\n    await installModule(\"total\", \"total\", affiliate_id);\n    await addAffiliateSettings(\n      \"affiliate_total\",\n      { affiliate_total_status: \"1\", affiliate_total_sort_order: \"100\" },\n      affiliate_id\n    );\n\n    // 3) Affiliate config settings\n    const affiliate_basic_settings = await getAffiliateBasicSettings();\n\n    const affiliate_setting = {};\n\n    if (price_schema === 1 || price_schema === 3) {\n      affiliate_setting[\"affiliate_config_markup\"] = default_markup ? default_markup : 30;\n    } else {\n      affiliate_setting[\"affiliate_config_markup\"] = 0;\n    }\n\n    affiliate_setting[\"affiliate_config_name\"] = business_name;\n    affiliate_setting[\"affiliate_config_url\"] = website;\n    affiliate_setting[\"affiliate_config_owner\"] = `${firstname} ${lastname}`.trim();\n\n    let fullAddress = address_1;\n    if (address_2 && address_2.trim() !== \"\") fullAddress += `, ${address_2}`;\n    fullAddress += `, ${city}`;\n    fullAddress += ` - ${postcode}`;\n\n    affiliate_setting[\"affiliate_config_address\"] = fullAddress;\n\n    affiliate_setting[\"affiliate_config_email\"] = email;\n    affiliate_setting[\"affiliate_config_telephone\"] = telephone;\n    affiliate_setting[\"affiliate_config_visible_telephone\"] = 1;\n    affiliate_setting[\"affiliate_config_meta_title\"] = business_name;\n\n    affiliate_setting[\"affiliate_config_country_id\"] = country_id;\n    affiliate_setting[\"affiliate_config_zone_id\"] = zone_id;\n\n    // ✅ keep your defaults (same as before)\n    affiliate_setting[\"affiliate_config_currency\"] = \"USD\";\n    affiliate_setting[\"affiliate_config_order_status_id\"] = 2;\n    affiliate_setting[\"affiliate_config_processing_status\"] = [2];\n    affiliate_setting[\"affiliate_config_complete_status\"] = [5, 15];\n\n    affiliate_setting[\"affiliate_config_image_category_width\"] = 1200;\n    affiliate_setting[\"affiliate_config_image_category_height\"] = 300;\n    affiliate_setting[\"affiliate_config_image_product_width\"] = 370;\n    affiliate_setting[\"affiliate_config_image_product_height\"] = 370;\n    affiliate_setting[\"affiliate_config_image_popup_width\"] = 1000;\n    affiliate_setting[\"affiliate_config_image_popup_height\"] = 1000;\n    affiliate_setting[\"affiliate_config_image_thumb_width\"] = 370;\n    affiliate_setting[\"affiliate_config_image_thumb_height\"] = 370;\n    affiliate_setting[\"affiliate_config_image_additional_width\"] = 475;\n    affiliate_setting[\"affiliate_config_image_additional_height\"] = 475;\n    affiliate_setting[\"affiliate_config_image_catalog_width\"] = 600;\n    affiliate_setting[\"affiliate_config_image_catalog_height\"] = 482;\n\n    affiliate_setting[\"affiliate_config_template\"] = \"default\";\n    affiliate_setting[\"affiliate_config_checkout_guest\"] = 1;\n    affiliate_setting[\"affiliate_config_apply_store_coupons\"] = 1;\n\n    affiliate_setting[\"affiliate_config_subscribe_status\"] = 1;\n    affiliate_setting[\"affiliate_config_subscribe_heading\"] = \"Subscribe to our Newsletter\";\n    affiliate_setting[\"affiliate_config_subscribe_top_text\"] = `<p style=\"margin-top:15px; line-height: 22px;\">Enter your email address to get the hottest deals Online. </p>\n<p style=\"margin-top:15px; line-height: 22px;\"><span style=\"font-weight: bold;\">You will be the first </span>to know about our offers, new arrivals, and more!<br></p>`;\n    affiliate_setting[\"affiliate_config_subscribe_bottom_text\"] = `<p style=\"line-height: 22px;\">We value our customers and will not share your email address to any third party. You will not be spammed.<br></p>`;\n    affiliate_setting[\"affiliate_config_subscribe_button_text\"] = \"\";\n    affiliate_setting[\"affiliate_config_subscribe_image_position\"] = \"left\";\n    affiliate_setting[\"affiliate_config_subscribe_success\"] =\n      \"Success: Your email address subscribed successfully!\";\n\n    const footer_description =\n      \"We are carrying the biggest collection for church fashions which includes all the designer church suits, church dresses and church hats.\";\n\n    affiliate_setting[\"affiliate_config_footer_description\"] =\n      affiliate_basic_settings?.[\"affiliate_basic_footer_description\"]\n        ? String(affiliate_basic_settings[\"affiliate_basic_footer_description\"])\n        : footer_description;\n\n    affiliate_setting[\"affiliate_config_catalog_column\"] = 3;\n\n    affiliate_setting[\"affiliate_config_pp_standard_email\"] = email;\n    affiliate_setting[\"affiliate_config_pp_standard_status\"] = 1;\n    affiliate_setting[\"affiliate_config_pp_standard_test\"] = 0;\n    affiliate_setting[\"affiliate_config_pp_standard_debug\"] = 0;\n    affiliate_setting[\"affiliate_config_pp_standard_transaction\"] = 1;\n\n    const header_tag_line = \"Leading Church Fashion Brand\";\n    affiliate_setting[\"affiliate_config_tagline\"] =\n      affiliate_basic_settings?.[\"affiliate_basic_tagline\"]\n        ? affiliate_basic_settings[\"affiliate_basic_tagline\"]\n        : header_tag_line;\n\n    affiliate_setting[\"affiliate_config_display_address\"] = 0;\n\n    await addAffiliateSettings(\"affiliate_config\", affiliate_setting, affiliate_id);\n\n    // 4) demo categories/products only if advanced\n    if (isTruthy(is_catalog_access)) {\n      const categories = await addAffiliateCategory(affiliate_id);\n      await addAffiliateProducts(affiliate_id, categories);\n    }\n\n    // 5) default pages\n    await addAffiliatePages(affiliate_id, [\n      { name: \"About Us\", description: \"About Us\", meta_title: \"About Us\", meta_description: \"About Us\", sort_order: \"1\", status: \"1\" },\n    ]);\n\n    // 6) banners + modules\n    await addLargeBanners(affiliate_id);\n    await addSmallBanners(affiliate_id);\n    await addCategoryProductsModule(affiliate_id);\n\n    return Response.json({ success: true, step: 3, affiliate_id });\n  }\n\n  // fallback (should never happen)\n  return Response.json({ message: \"Invalid step\" }, { status: 400 });\n}"],"names":[],"mappings":"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"}}]
}