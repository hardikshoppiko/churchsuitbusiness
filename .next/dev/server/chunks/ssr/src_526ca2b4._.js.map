{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/apcrat/Documents/react/church_suit_business/affiliates/src/lib/auth.js"],"sourcesContent":["import { SignJWT, jwtVerify } from \"jose\";\nimport { cookies } from \"next/headers\";\n\nconst COOKIE_NAME = \"wsf_session\";\nconst MAX_AGE_SEC = 60 * 60 * 24 * 7; // 7 days\n\nfunction getSecret() {\n  const s = process.env.AUTH_SECRET;\n  if (!s) throw new Error(\"AUTH_SECRET is missing in .env.local\");\n  return new TextEncoder().encode(s);\n}\n\nexport async function createSession(payload) {\n  const token = await new SignJWT(payload)\n    .setProtectedHeader({ alg: \"HS256\" })\n    .setIssuedAt()\n    .setExpirationTime(`${MAX_AGE_SEC}s`)\n    .sign(getSecret());\n\n  // âœ… cookies() is async in Route Handlers\n  const cookieStore = await cookies();\n\n  cookieStore.set(COOKIE_NAME, token, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === \"production\",\n    sameSite: \"lax\",\n    path: \"/\",\n    maxAge: MAX_AGE_SEC,\n  });\n\n  return token;\n}\n\nexport async function clearSession() {\n  const cookieStore = await cookies();\n\n  cookieStore.set(COOKIE_NAME, \"\", {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === \"production\",\n    sameSite: \"lax\",\n    path: \"/\",\n    maxAge: 0,\n  });\n}\n\nexport async function getSession() {\n  const cookieStore = await cookies();\n  const token = cookieStore.get(COOKIE_NAME)?.value;\n  if (!token) return null;\n\n  try {\n    const { payload } = await jwtVerify(token, getSecret());\n    return payload;\n  } catch {\n    return null;\n  }\n}"],"names":[],"mappings":";;;;;;;;AAAA;AAAA;AACA;;;AAEA,MAAM,cAAc;AACpB,MAAM,cAAc,KAAK,KAAK,KAAK,GAAG,SAAS;AAE/C,SAAS;IACP,MAAM,IAAI,QAAQ,GAAG,CAAC,WAAW;IACjC,IAAI,CAAC,GAAG,MAAM,IAAI,MAAM;IACxB,OAAO,IAAI,cAAc,MAAM,CAAC;AAClC;AAEO,eAAe,cAAc,OAAO;IACzC,MAAM,QAAQ,MAAM,IAAI,gKAAO,CAAC,SAC7B,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,GAAG,YAAY,CAAC,CAAC,EACnC,IAAI,CAAC;IAER,yCAAyC;IACzC,MAAM,cAAc,MAAM,IAAA,0IAAO;IAEjC,YAAY,GAAG,CAAC,aAAa,OAAO;QAClC,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;QACV,MAAM;QACN,QAAQ;IACV;IAEA,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,0IAAO;IAEjC,YAAY,GAAG,CAAC,aAAa,IAAI;QAC/B,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;QACV,MAAM;QACN,QAAQ;IACV;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,0IAAO;IACjC,MAAM,QAAQ,YAAY,GAAG,CAAC,cAAc;IAC5C,IAAI,CAAC,OAAO,OAAO;IAEnB,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,oKAAS,EAAC,OAAO;QAC3C,OAAO;IACT,EAAE,OAAM;QACN,OAAO;IACT;AACF"}},
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///Users/apcrat/Documents/react/church_suit_business/affiliates/src/app/account/%28protected%29/layout.js"],"sourcesContent":["import { getSession } from \"@/lib/auth\";\nimport { redirect } from \"next/navigation\";\n\nexport default async function ProtectedLayout({ children }) {\n  const session = await getSession();\n\n  if (!session) {\n    redirect(\"/account/login\");\n  }\n  \n  return children;\n}"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;;;AAEe,eAAe,gBAAgB,EAAE,QAAQ,EAAE;IACxD,MAAM,UAAU,MAAM,IAAA,gIAAU;IAEhC,IAAI,CAAC,SAAS;QACZ,IAAA,iMAAQ,EAAC;IACX;IAEA,OAAO;AACT"}}]
}