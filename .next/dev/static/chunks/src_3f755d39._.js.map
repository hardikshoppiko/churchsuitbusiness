{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/apcrat/Documents/react/church_suit_business/affiliates/src/components/ui/card.jsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/db-utils\";\n\nfunction Card({\n  className,\n  ...props\n}) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props} />\n  );\n}\n\nfunction CardHeader({\n  className,\n  ...props\n}) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props} />\n  );\n}\n\nfunction CardTitle({\n  className,\n  ...props\n}) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props} />\n  );\n}\n\nfunction CardDescription({\n  className,\n  ...props\n}) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props} />\n  );\n}\n\nfunction CardAction({\n  className,\n  ...props\n}) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props} />\n  );\n}\n\nfunction CardContent({\n  className,\n  ...props\n}) {\n  return (<div data-slot=\"card-content\" className={cn(\"px-6\", className)} {...props} />);\n}\n\nfunction CardFooter({\n  className,\n  ...props\n}) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props} />\n  );\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAA;AAEA;;;;AAEA,SAAS,KAAK,EACZ,SAAS,EACT,GAAG,OACJ;IACC,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,kIAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAEf;KAbS;AAeT,SAAS,WAAW,EAClB,SAAS,EACT,GAAG,OACJ;IACC,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,kIAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAEf;MAbS;AAeT,SAAS,UAAU,EACjB,SAAS,EACT,GAAG,OACJ;IACC,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,kIAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAEf;MAVS;AAYT,SAAS,gBAAgB,EACvB,SAAS,EACT,GAAG,OACJ;IACC,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,kIAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAEf;MAVS;AAYT,SAAS,WAAW,EAClB,SAAS,EACT,GAAG,OACJ;IACC,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,kIAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAEf;MAbS;AAeT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACJ;IACC,qBAAQ,6LAAC;QAAI,aAAU;QAAe,WAAW,IAAA,kIAAE,EAAC,QAAQ;QAAa,GAAG,KAAK;;;;;;AACnF;MALS;AAOT,SAAS,WAAW,EAClB,SAAS,EACT,GAAG,OACJ;IACC,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,kIAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAEf;MAVS"}},
    {"offset": {"line": 126, "column": 0}, "map": {"version":3,"sources":["file:///Users/apcrat/Documents/react/church_suit_business/affiliates/src/app/register/payment/%5Baffiliate_id%5D/payment-client.js"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport {\n  Elements,\n  PaymentElement,\n  useElements,\n  useStripe,\n} from \"@stripe/react-stripe-js\";\n\nimport {\n  Card,\n  CardContent,\n  CardHeader,\n  CardTitle,\n  CardDescription,\n} from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\n\nconst stripePromise = loadStripe(process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY);\n\nfunction CheckoutForm({ affiliateId }) {\n  const stripe = useStripe();\n  const elements = useElements();\n\n  const [loading, setLoading] = useState(false);\n  const [err, setErr] = useState(null);\n\n  async function onPay(e) {\n    e.preventDefault();\n    setErr(null);\n\n    if (!stripe || !elements) return;\n\n    setLoading(true);\n\n    const { error } = await stripe.confirmPayment({\n      elements,\n      confirmParams: {\n        return_url: `${window.location.origin}/register/payment/${affiliateId}/success`,\n      },\n    });\n\n    if (error) {\n      setErr(error.message || \"Payment failed.\");\n      setLoading(false);\n      return;\n    }\n  }\n\n  return (\n    <Card className=\"rounded-2xl\">\n      <CardHeader>\n        <CardTitle className=\"text-base\">Payment</CardTitle>\n        <CardDescription>\n          Choose your payment method and confirm.\n        </CardDescription>\n      </CardHeader>\n\n      <CardContent className=\"space-y-4\">\n        {err ? (\n          <div className=\"rounded-xl border border-red-200 bg-red-50 p-4 text-red-700\">\n            <div className=\"text-sm font-semibold\">Payment Error</div>\n            <div className=\"mt-1 text-sm\">{err}</div>\n          </div>\n        ) : null}\n\n        <form onSubmit={onPay} className=\"space-y-4\">\n          <div className=\"rounded-xl border bg-background p-4\">\n            <PaymentElement\n              options={{\n                layout: {\n                  type: \"tabs\",\n                  defaultCollapsed: false,\n                },\n              }}\n            />\n          </div>\n\n          <Button\n            type=\"submit\"\n            className=\"w-full\"\n            size=\"lg\"\n            disabled={!stripe || loading}\n          >\n            {loading ? \"Processing...\" : \"Pay now & Activate Subscription\"}\n          </Button>\n\n          <p className=\"text-center text-xs text-muted-foreground\">\n            Payments are processed by Stripe securely.\n          </p>\n        </form>\n      </CardContent>\n    </Card>\n  );\n}\n\nexport default function PaymentClient({ affiliateId }) {\n  const [clientSecret, setClientSecret] = useState(null);\n  const [paid, setPaid] = useState(false);\n  const [err, setErr] = useState(null);\n\n  if (!affiliateId || Number.isNaN(Number(affiliateId))) {\n    return (\n      <div className=\"rounded-xl border border-red-200 bg-red-50 p-4 text-red-700\">\n        <div className=\"text-sm font-semibold\">Invalid URL</div>\n        <div className=\"mt-1 text-sm\">Invalid affiliate id in URL.</div>\n      </div>\n    );\n  }\n\n  useEffect(() => {\n    let mounted = true;\n\n    async function init() {\n      setErr(null);\n\n      const res = await fetch(`/api/affiliate/payment-intent`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ affiliate_id: affiliateId }),\n        cache: \"no-store\",\n      });\n\n      const data = await res.json().catch(() => ({}));\n      if (!mounted) return;\n\n      if (!res.ok) {\n        setErr(data?.message || \"Could not initialize payment.\");\n        return;\n      }\n\n      if (data.affiliate_status === \"paid\") {\n        setPaid(true);\n        return;\n      }\n\n      setClientSecret(data.clientSecret);\n    }\n\n    init();\n    return () => {\n      mounted = false;\n    };\n  }, [affiliateId]);\n\n  // ✅ Shadcn-like Stripe appearance\n  const options = useMemo(() => {\n    if (!clientSecret) return null;\n\n    return {\n      clientSecret,\n      appearance: {\n        theme: \"flat\",\n        labels: \"floating\",\n\n        variables: {\n          // Font (close to shadcn default: Inter)\n          fontFamily:\n            \"Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial\",\n\n          // Colors (neutral shadcn feel)\n          colorText: \"hsl(222.2 84% 4.9%)\",\n          colorTextSecondary: \"hsl(215.4 16.3% 46.9%)\",\n          colorTextPlaceholder: \"hsl(215.4 16.3% 46.9%)\",\n\n          colorBackground: \"hsl(0 0% 100%)\",\n          colorPrimary: \"hsl(221.2 83.2% 53.3%)\", // primary-ish blue\n          colorDanger: \"hsl(0 84.2% 60.2%)\",\n\n          // Borders / radius\n          borderRadius: \"12px\",\n          borderWidth: \"1px\",\n\n          // Spacing\n          spacingUnit: \"6px\",\n        },\n\n        rules: {\n          // Base input style\n          \".Input\": {\n            border: \"1px solid hsl(214.3 31.8% 91.4%)\",\n            boxShadow: \"none\",\n            backgroundColor: \"hsl(0 0% 100%)\",\n          },\n\n          // Focus ring like shadcn\n          \".Input:focus\": {\n            border: \"1px solid hsl(221.2 83.2% 53.3%)\",\n            boxShadow: \"0 0 0 4px hsl(221.2 83.2% 53.3% / 0.15)\",\n          },\n\n          // Floating labels\n          \".Label\": {\n            color: \"hsl(215.4 16.3% 46.9%)\",\n            fontWeight: \"600\",\n          },\n\n          // Tabs look cleaner\n          \".Tab\": {\n            border: \"1px solid hsl(214.3 31.8% 91.4%)\",\n            borderRadius: \"12px\",\n            backgroundColor: \"hsl(0 0% 100%)\",\n          },\n          \".Tab:hover\": {\n            backgroundColor: \"hsl(210 40% 98%)\",\n          },\n          \".Tab--selected\": {\n            borderColor: \"hsl(221.2 83.2% 53.3%)\",\n            boxShadow: \"0 0 0 4px hsl(221.2 83.2% 53.3% / 0.12)\",\n          },\n\n          // Errors\n          \".Input--invalid\": {\n            borderColor: \"hsl(0 84.2% 60.2%)\",\n          },\n          \".Input--invalid:focus\": {\n            boxShadow: \"0 0 0 4px hsl(0 84.2% 60.2% / 0.15)\",\n          },\n          \".Error\": {\n            color: \"hsl(0 84.2% 60.2%)\",\n          },\n\n          // Block container inside PaymentElement\n          \".Block\": {\n            border: \"1px solid hsl(214.3 31.8% 91.4%)\",\n            borderRadius: \"16px\",\n          },\n        },\n      },\n    };\n  }, [clientSecret]);\n\n  if (paid) {\n    return (\n      <Card className=\"rounded-2xl\">\n        <CardHeader>\n          <CardTitle className=\"text-base\">Payment Status</CardTitle>\n          <CardDescription>Subscription already active.</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"rounded-xl border border-green-200 bg-green-50 p-4 text-green-700\">\n            <div className=\"text-sm font-semibold\">Payment Completed</div>\n            <div className=\"mt-1 text-sm\">Payment already completed.</div>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (err) {\n    return (\n      <Card className=\"rounded-2xl\">\n        <CardHeader>\n          <CardTitle className=\"text-base\">Payment Status</CardTitle>\n          <CardDescription>We couldn’t start payment.</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"rounded-xl border border-red-200 bg-red-50 p-4 text-red-700\">\n            <div className=\"text-sm font-semibold\">Error</div>\n            <div className=\"mt-1 text-sm\">{err}</div>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (!clientSecret || !options) {\n    return (\n      <Card className=\"rounded-2xl\">\n        <CardHeader>\n          <CardTitle className=\"text-base\">Payment</CardTitle>\n          <CardDescription>Loading secure payment form…</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"h-10 w-full animate-pulse rounded-xl bg-muted\" />\n          <div className=\"mt-3 h-24 w-full animate-pulse rounded-xl bg-muted\" />\n          <div className=\"mt-3 h-10 w-full animate-pulse rounded-xl bg-muted\" />\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Elements stripe={stripePromise} options={options}>\n      <CheckoutForm affiliateId={affiliateId} />\n    </Elements>\n  );\n}"],"names":[],"mappings":"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"}}]
}