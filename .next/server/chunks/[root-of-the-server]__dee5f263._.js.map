{"version":3,"sources":["../../../node_modules/clsx/dist/clsx.mjs","../../../node_modules/php-serialize/lib/esm/parser.js","../../../node_modules/php-serialize/lib/esm/helpers.js","../../../node_modules/php-serialize/lib/esm/unserialize.js","../../../node_modules/php-serialize/lib/esm/serialize.js","../../../node_modules/php-serialize/lib/esm/isSerialized.js","../../../src/lib/db-utils.js","../../../src/app/api/affiliate/payment-intent/route.js","../../../node_modules/next/dist/esm/build/templates/app-route.js","../../../src/lib/affiliate-payment-service.js"],"sourcesContent":["function r(e){var t,f,n=\"\";if(\"string\"==typeof e||\"number\"==typeof e)n+=e;else if(\"object\"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(f=r(e[t]))&&(n&&(n+=\" \"),n+=f)}else for(f in e)e[f]&&(n&&(n+=\" \"),n+=f);return n}export function clsx(){for(var e,t,f=0,n=\"\",o=arguments.length;f<o;f++)(e=arguments[f])&&(t=r(e))&&(n&&(n+=\" \"),n+=t);return n}export default clsx;","var __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar PARSER_TYPES = {\n    N: 'null',\n    i: 'int',\n    d: 'float',\n    b: 'boolean',\n    s: 'string',\n    a: 'array-object',\n    C: 'serializable-class',\n    O: 'notserializable-class',\n};\nvar Parser = /** @class */ (function () {\n    function Parser(contents, index, options) {\n        this.contents = contents;\n        this.index = index;\n        this.options = options;\n    }\n    Parser.prototype.error = function (message) {\n        if (message === void 0) { message = 'Syntax Error'; }\n        return new Error(message + \" at index \" + this.index + \" while unserializing payload\");\n    };\n    Parser.prototype.advance = function (index) {\n        this.index += index;\n    };\n    Parser.prototype.readAhead = function (index) {\n        var contents = this.peekAhead(index);\n        this.index += index;\n        return contents;\n    };\n    Parser.prototype.readUntil = function (expected) {\n        var index = this.contents.indexOf(expected, this.index);\n        if (index === -1) {\n            throw this.error(\"Expected '\" + expected + \"'\");\n        }\n        return this.readAhead(index - this.index);\n    };\n    Parser.prototype.peekAhead = function (index) {\n        return this.contents.toString(this.options.encoding, this.index, this.index + index);\n    };\n    Parser.prototype.seekExpected = function (contents) {\n        var slice = this.readAhead(contents.length);\n        if (slice !== contents) {\n            this.index -= contents.length;\n            throw this.error(\"Expected '\" + contents + \"'\");\n        }\n    };\n    Parser.prototype.getType = function () {\n        var _a = __read(this.readAhead(2), 2), type = _a[0], ps = _a[1];\n        var parserType = PARSER_TYPES[type];\n        if (!parserType) {\n            throw this.error('Unknown type');\n        }\n        if (parserType === 'null' ? ps !== ';' : ps !== ':') {\n            throw this.error();\n        }\n        return parserType;\n    };\n    Parser.prototype.getLength = function () {\n        var length = Number.parseInt(this.readUntil(':'), 10);\n        if (Number.isNaN(length)) {\n            throw this.error();\n        }\n        return length;\n    };\n    Parser.prototype.getByLength = function (startSequence, endSequence, callback) {\n        var length = this.getLength();\n        this.seekExpected(\":\" + startSequence);\n        var result = callback(length);\n        this.seekExpected(endSequence);\n        return result;\n    };\n    return Parser;\n}());\nexport default Parser;\n","// eslint-disable-next-line camelcase,@typescript-eslint/class-name-casing\nvar __PHP_Incomplete_Class = /** @class */ (function () {\n    function __PHP_Incomplete_Class(name) {\n        this.__PHP_Incomplete_Class_Name = name;\n    }\n    return __PHP_Incomplete_Class;\n}());\nexport { __PHP_Incomplete_Class };\nexport function getByteLength(contents, options) {\n    if (typeof Buffer !== 'undefined') {\n        return Buffer.byteLength(contents, options.encoding);\n    }\n    return encodeURIComponent(contents).replace(/%[A-F\\d]{2}/g, 'U').length;\n}\n// isInteger = is NOT a float but still a number\nexport function isInteger(value) {\n    return typeof value === 'number' && Number.parseInt(value.toString(), 10) === value;\n}\nexport function getIncompleteClass(name) {\n    return new __PHP_Incomplete_Class(name);\n}\nexport function getClass(prototype) {\n    function PhpClass() {\n        // No Op\n    }\n    PhpClass.prototype = prototype;\n    return PhpClass;\n}\n/**\n * Ensures that the given {@link value} is truthy, throws an {@link Error} otherwise.\n * @param value the value to check to be truthy.\n * @param message the message of the {@link Error} if the value is falsy.\n */\nexport function invariant(value, message) {\n    if (!value) {\n        throw new Error(message);\n    }\n}\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\n// eslint-disable-next-line import/no-cycle\nimport Parser from './parser';\nimport { isInteger, getClass, getIncompleteClass, __PHP_Incomplete_Class, invariant } from './helpers';\nfunction getClassReference(className, scope, strict) {\n    var container;\n    var classReference = scope[className];\n    invariant(classReference || !strict, \"Class \" + className + \" not found in given scope\");\n    if (classReference) {\n        // @ts-ignore\n        container = new (getClass(classReference.prototype))();\n    }\n    else {\n        container = getIncompleteClass(className);\n    }\n    return container;\n}\nfunction unserializePairs(parser, length, scope, options) {\n    var pairs = [];\n    for (var i = 0; i < length; i += 1) {\n        var key = unserializeItem(parser, scope, options);\n        parser.seekExpected(';');\n        var value = unserializeItem(parser, scope, options);\n        if (parser.peekAhead(1) === ';') {\n            parser.advance(1);\n        }\n        pairs.push({ key: key, value: value });\n    }\n    return pairs;\n}\nfunction unserializeItem(parser, scope, options) {\n    var type = parser.getType();\n    if (type === 'null') {\n        return null;\n    }\n    if (type === 'int' || type === 'float') {\n        var value = parser.readUntil(';');\n        var parsedValue = type === 'int' ? parseInt(value, 10) : parseFloat(value);\n        if (parsedValue.toString() !== value) {\n            if (!value.includes('.')) {\n                parsedValue = BigInt(value); // Only convert to BigInt if there's no decimal\n            }\n            else {\n                parsedValue = parseFloat(value); // Ensure floats remain as float\n            }\n        }\n        return parsedValue;\n    }\n    if (type === 'boolean') {\n        var value = parser.readAhead(1);\n        return value === '1';\n    }\n    if (type === 'string') {\n        return parser.getByLength('\"', '\"', function (length) { return parser.readAhead(length); });\n    }\n    if (type === 'array-object') {\n        var pairs = parser.getByLength('{', '}', function (length) { return unserializePairs(parser, length, scope, options); });\n        var isArray = pairs.every(function (item, idx) { return isInteger(item.key) && idx === item.key; });\n        var result_1 = isArray ? [] : {};\n        pairs.forEach(function (_a) {\n            var key = _a.key, value = _a.value;\n            result_1[key] = value;\n        });\n        return result_1;\n    }\n    if (type === 'notserializable-class') {\n        var name = parser.getByLength('\"', '\"', function (length) { return parser.readAhead(length); });\n        parser.seekExpected(':');\n        var pairs = parser.getByLength('{', '}', function (length) { return unserializePairs(parser, length, scope, options); });\n        var result_2 = getClassReference(name, scope, options.strict);\n        var PREFIX_PRIVATE_1 = \"\\0\" + name + \"\\0\";\n        var PREFIX_PROTECTED_1 = \"\\0*\\0\";\n        pairs.forEach(function (_a) {\n            var key = _a.key, value = _a.value;\n            if (key.startsWith(PREFIX_PRIVATE_1)) {\n                // Private field\n                result_2[key.slice(PREFIX_PRIVATE_1.length)] = value;\n            }\n            else if (key.startsWith(PREFIX_PROTECTED_1)) {\n                // Protected field\n                result_2[key.slice(PREFIX_PROTECTED_1.length)] = value;\n            }\n            else {\n                result_2[key] = value;\n            }\n        });\n        return result_2;\n    }\n    if (type === 'serializable-class') {\n        var name = parser.getByLength('\"', '\"', function (length) { return parser.readAhead(length); });\n        parser.seekExpected(':');\n        var payload = parser.getByLength('{', '}', function (length) { return parser.readAhead(length); });\n        var result = getClassReference(name, scope, options.strict);\n        if (!(result instanceof __PHP_Incomplete_Class)) {\n            invariant(result.unserialize, \"unserialize not found on class when processing '\" + name + \"'\");\n            result.unserialize(payload);\n        }\n        return result;\n    }\n    throw new Error(\"Invalid type '\" + type + \"' encounterd while unserializing\");\n}\nfunction unserialize(item, scope, givenOptions) {\n    if (scope === void 0) { scope = {}; }\n    if (givenOptions === void 0) { givenOptions = {}; }\n    var options = __assign({}, givenOptions);\n    if (typeof options.strict === 'undefined') {\n        options.strict = true;\n    }\n    if (typeof options.encoding === 'undefined') {\n        options.encoding = 'utf8';\n    }\n    var parser = new Parser(Buffer.from(item), 0, options);\n    return unserializeItem(parser, scope, options);\n}\nexport default unserialize;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nimport { isInteger, getByteLength, invariant } from './helpers';\nfunction getClassNamespace(item, scope) {\n    return (Object.keys(scope).find(function (key) { return item instanceof scope[key]; }) || item.__PHP_Incomplete_Class_Name || item.constructor.name);\n}\nfunction serializeObject(item, scope) {\n    var processed = Array.isArray(item)\n        ? item.map(function (value, index) { return \"\" + serialize(index, scope) + serialize(value, scope); })\n        : Object.keys(item).map(function (key) { return \"\" + serialize(key, scope) + serialize(item[key], scope); });\n    var length = processed.filter(function (entry) { return typeof entry !== 'undefined'; }).length;\n    return length + \":{\" + processed.join('') + \"}\";\n}\nexport default function serialize(item, scope, givenOptions) {\n    if (scope === void 0) { scope = {}; }\n    if (givenOptions === void 0) { givenOptions = {}; }\n    var type = typeof item;\n    var options = __assign({}, givenOptions);\n    if (typeof options.encoding === 'undefined') {\n        options.encoding = 'utf8';\n    }\n    if (item === null) {\n        return 'N;';\n    }\n    if (type === 'number' || type === 'bigint') {\n        if (typeof item === 'bigint' || isInteger(item)) {\n            return \"i:\" + item + \";\";\n        }\n        return \"d:\" + item.toString().toUpperCase() + \";\";\n    }\n    if (type === 'string') {\n        return \"s:\" + getByteLength(item, options) + \":\\\"\" + item + \"\\\";\";\n    }\n    if (type === 'boolean') {\n        return \"b:\" + (item ? '1' : '0') + \";\";\n    }\n    if (type !== 'object') {\n        throw new TypeError(\"Unexpected type '\" + type + \"' encountered while attempting to serialize\");\n    }\n    if (Array.isArray(item) || item.constructor.name === 'Object') {\n        return \"a:\" + serializeObject(item, scope);\n    }\n    if (item instanceof Map) {\n        return \"a:\" + item.size + \":{\" + Array.from(item.entries())\n            .map(function (_a) {\n            var _b = __read(_a, 2), key = _b[0], value = _b[1];\n            return \"\" + serialize(key, scope) + serialize(value, scope);\n        })\n            .join('') + \"}\";\n    }\n    var constructorName = getClassNamespace(item, scope);\n    if (typeof item.serialize === 'function') {\n        var serialized = item.serialize();\n        invariant(typeof serialized === 'string', item.constructor.name + \".serialize should return a string\");\n        return \"C:\" + constructorName.length + \":\\\"\" + constructorName + \"\\\":\" + getByteLength(serialized, options) + \":{\" + serialized + \"}\";\n    }\n    return \"O:\" + constructorName.length + \":\\\"\" + constructorName + \"\\\":\" + serializeObject(item, scope);\n}\n","/**\n * Check value to find if it was serialized.\n * @param { string } item - Value to check to see if was serialized.\n * @param { boolean } strict - Whether to be strict about the end of the string. Default value: false\n */\nexport default function isSerialized(givenItem, strict) {\n    if (strict === void 0) { strict = false; }\n    if (typeof givenItem !== 'string') {\n        return false;\n    }\n    var item = givenItem.replace(/^(\\s*)|(\\s*)$/g, '');\n    if (item === 'N;') {\n        return true;\n    }\n    if (item.length < 4) {\n        return false;\n    }\n    if (item[1] !== ':') {\n        return false;\n    }\n    if (strict) {\n        var lastc = item.slice(-1);\n        if (lastc !== ';' && lastc !== '}') {\n            return false;\n        }\n    }\n    else {\n        var semicolon = item.indexOf(';');\n        var brace = item.indexOf('}');\n        // Either ; or } must exist.\n        if (semicolon === -1 && brace === -1) {\n            return false;\n        }\n        // But neither must be in the first X characters.\n        if (semicolon !== -1 && semicolon < 3) {\n            return false;\n        }\n        if (brace !== -1 && brace < 4) {\n            return false;\n        }\n    }\n    var token = item.slice(0, 1);\n    var end = strict ? '$' : '';\n    switch (token) {\n        case 's':\n        case 'a':\n        case 'O':\n            if (strict) {\n                if (item.substr(-2, 1) !== '\"') {\n                    return false;\n                }\n            }\n            else if (item.indexOf('\"') === -1) {\n                return false;\n            }\n            return item.match(new RegExp(\"^\" + token + \":[0-9]+:\", 's')) !== null;\n        case 'b':\n        case 'i':\n        case 'd':\n            return item.match(new RegExp(\"^\" + token + \":[0-9.E+-]+;\" + end)) !== null;\n        default:\n    }\n    return false;\n}\n","import { clsx } from \"clsx\";\nimport { twMerge } from \"tailwind-merge\";\nimport crypto from \"crypto\";\nimport { serialize as phpSerialize } from \"php-serialize\";\n\n/**\n * shadcn utility: merges tailwind classes safely\n */\nexport function cn(...inputs) {\n  return twMerge(clsx(inputs));\n}\n\nexport function sha1(str) {\n  return crypto.createHash(\"sha1\").update(String(str)).digest(\"hex\");\n}\n\n// OpenCart-compatible 9-char salt\nexport function generateSalt() {\n  return crypto\n    .createHash(\"md5\")\n    .update(crypto.randomBytes(16).toString(\"hex\") + Date.now())\n    .digest(\"hex\")\n    .substring(0, 9);\n}\n\n// OpenCart hash: sha1(salt . sha1(salt . sha1(password)))\nexport function ocHashPassword(password, salt) {\n  return sha1(salt + sha1(salt + sha1(password)));\n}\n\nexport function ocVerifyPassword(inputPassword, storedSalt, storedHash) {\n  return ocHashPassword(inputPassword, storedSalt) === storedHash;\n}\n\n// OpenCart-style db escape (like $this->db->escape)\nexport function dbEscape(value) {\n  if (value === null || value === undefined) return \"\";\n  return String(value)\n    .replace(/\\\\/g, \"\\\\\\\\\")\n    .replace(/\\u0008/g, \"\\\\b\")\n    .replace(/\\t/g, \"\\\\t\")\n    .replace(/\\0/g, \"\\\\0\")\n    .replace(/\\n/g, \"\\\\n\")\n    .replace(/\\r/g, \"\\\\r\")\n    .replace(/\\u001a/g, \"\\\\Z\")\n    .replace(/\\x1a/g, \"\\\\Z\")\n    .replace(/'/g, \"\\\\'\")\n    .replace(/\"/g, '\\\\\"');\n}\n\n// Save only domain (remove https:// and www)\nexport function stripWebsite(url = \"\") {\n  return String(url)\n    .trim()\n    .replace(/^https?:\\/\\//i, \"\")\n    .replace(/^www\\./i, \"\")\n    .replace(/\\/+$/, \"\");\n}\n\nexport function isEmail(v) {\n  return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]{2,}$/.test(String(v || \"\").trim());\n}\n\nexport function isTenDigitPhone(v) {\n  return /^\\d{10}$/.test(String(v || \"\").trim());\n}\n\nexport function normalizeLogin(v) {\n  return String(v || \"\").trim();\n}\n\nexport function ocSerialize(value) {\n  return phpSerialize(value);\n}\n\nexport function isTruthy(v) {\n  return v === true || v === 1 || v === \"1\" || String(v).toLowerCase() === \"true\";\n}\n\nexport function getClientIp(req) {\n  if (!req?.headers) return \"127.0.0.1\";\n\n  // Proxy / Load balancer / Vercel\n  const xForwardedFor = req.headers.get(\"x-forwarded-for\");\n  if (xForwardedFor) {\n    // Can be: \"client, proxy1, proxy2\"\n    return xForwardedFor.split(\",\")[0].trim();\n  }\n\n  // Cloudflare\n  const cfIp = req.headers.get(\"cf-connecting-ip\");\n  if (cfIp) return cfIp;\n\n  // Fallback (local dev)\n  return \"127.0.0.1\";\n}\n\nexport function getFrontClientIp() {\n  const h = headers();\n\n  // Common proxy headers\n  const xff = h.get(\"x-forwarded-for\");\n  if (xff) return xff.split(\",\")[0].trim();\n\n  const realIp = h.get(\"x-real-ip\");\n  if (realIp) return realIp.trim();\n\n  // Fallback\n  return \"0.0.0.0\";\n}\n\nexport function money(v) {\n  const n = Number(v || 0);\n  return Number.isFinite(n) ? `$${n.toFixed(2)}` : \"$0.00\";\n}\n\nfunction parseDate(input) {\n  if (!input) return null;\n\n  // Already Date object\n  if (input instanceof Date) {\n    return isNaN(input.getTime()) ? null : input;\n  }\n\n  if (typeof input !== \"string\") return null;\n\n  // ISO or yyyy-mm-dd hh:mm:ss (MySQL)\n  if (/^\\d{4}-\\d{2}-\\d{2}/.test(input)) {\n    const d = new Date(input.replace(\" \", \"T\"));\n    return isNaN(d.getTime()) ? null : d;\n  }\n\n  // dd/mm/yyyy or dd/mm/yyyy hh:mm:ss\n  if (/^\\d{2}\\/\\d{2}\\/\\d{4}/.test(input)) {\n    const [datePart, timePart] = input.split(\" \");\n    const [dd, mm, yyyy] = datePart.split(\"/\");\n\n    const iso = `${yyyy}-${mm}-${dd}${timePart ? \"T\" + timePart : \"\"}`;\n    const d = new Date(iso);\n    return isNaN(d.getTime()) ? null : d;\n  }\n\n  // Fallback: let JS try\n  const d = new Date(input);\n  return isNaN(d.getTime()) ? null : d;\n}\n\n/**\n * Format date as MM/DD/YYYY (default)\n */\nexport function formatDate(input, format = \"MM/DD/YYYY\") {\n  const d = parseDate(input);\n\n  if (!d) return \"\";\n\n  const map = {\n    DD: String(d.getDate()).padStart(2, \"0\"),\n    MM: String(d.getMonth() + 1).padStart(2, \"0\"),\n    YYYY: d.getFullYear(),\n    HH: String(d.getHours()).padStart(2, \"0\"),\n    mm: String(d.getMinutes()).padStart(2, \"0\"),\n    ss: String(d.getSeconds()).padStart(2, \"0\"),\n  };\n\n  return format.replace(/DD|MM|YYYY|HH|mm|ss/g, (k) => map[k]);\n}","import { db } from \"@/lib/db\";\nimport { dbEscape } from \"@/lib/db-utils\";\n\nimport { getSubscriptionClientSecret } from \"@/lib/affiliate-payment-service\";\n\nexport async function POST(req) {\n  const body = await req.json().catch(() => ({}));\n  const affiliate_id = body?.affiliate_id;\n\n  if (!affiliate_id) {\n    return Response.json({ message: \"affiliate_id is required\" }, { status: 400 });\n  }\n\n  const result = await getSubscriptionClientSecret(affiliate_id);\n\n  if (result.affiliate_status === \"not_found\") {\n    return Response.json({ message: \"Affiliate not found\" }, { status: 404 });\n  }\n\n  if (result.affiliate_status === \"paid\") {\n    return Response.json({ affiliate_status: \"paid\" });\n  }\n\n  if (result.affiliate_status === \"error\") {\n    return Response.json({ message: result.message || \"Payment init failed\" }, { status: 500 });\n  }\n\n  return Response.json({\n    affiliate_status: \"ready\",\n    clientSecret: result.clientSecret,\n  });\n}\n\n/**\n * âœ… GET (NEW)\n * Used by success page to show affiliate + last payment info\n *\n * Example:\n * /api/affiliate/payment-intent?affiliate_id=123\n */\nexport async function GET(req) {\n  try {\n    const url = new URL(req.url);\n    const affiliate_id = Number(url.searchParams.get(\"affiliate_id\") || 0);\n\n    if (!affiliate_id) {\n      return Response.json({ message: \"affiliate_id is required\" }, { status: 400 });\n    }\n\n    // Affiliate info\n    const [affRows] = await db.query(`SELECT * FROM affiliate WHERE affiliate_id=${affiliate_id}`);\n\n    const affiliate = affRows?.[0] || null;\n\n    if (!affiliate) {\n      return Response.json({ message: \"Affiliate not found\" }, { status: 404 });\n    }\n\n    // Latest payment row (for UI)\n    const [payRows] = await db.query(`SELECT affiliate_payment_id, payment_charge_id, invoice_number, amount, start_date, end_date, payment_status, date_added FROM affiliate_payment WHERE affiliate_id=${affiliate_id} ORDER BY affiliate_payment_id DESC LIMIT 1`);\n\n    const latest_payment = payRows?.[0] || null;\n\n    // Stage helper (first vs renewal)\n    const [firstPaidRows] = await db.query(`SELECT affiliate_payment_id FROM affiliate_payment WHERE affiliate_id=${affiliate_id} AND payment_status=1 ORDER BY affiliate_payment_id ASC LIMIT 1`);\n\n    const payment_stage = firstPaidRows?.length ? \"renewal\" : \"first\";\n\n    return Response.json({\n      success: true,\n      affiliate,\n      latest_payment,\n      payment_stage,\n    });\n  } catch (e) {\n    return Response.json({ message: e?.message || \"Server error\" }, { status: 500 });\n  }\n}","import { AppRouteRouteModule } from \"next/dist/esm/server/route-modules/app-route/module.compiled\";\nimport { RouteKind } from \"next/dist/esm/server/route-kind\";\nimport { patchFetch as _patchFetch } from \"next/dist/esm/server/lib/patch-fetch\";\nimport { addRequestMeta, getRequestMeta } from \"next/dist/esm/server/request-meta\";\nimport { getTracer, SpanKind } from \"next/dist/esm/server/lib/trace/tracer\";\nimport { setManifestsSingleton } from \"next/dist/esm/server/app-render/manifests-singleton\";\nimport { normalizeAppPath } from \"next/dist/esm/shared/lib/router/utils/app-paths\";\nimport { NodeNextRequest, NodeNextResponse } from \"next/dist/esm/server/base-http/node\";\nimport { NextRequestAdapter, signalFromNodeResponse } from \"next/dist/esm/server/web/spec-extension/adapters/next-request\";\nimport { BaseServerSpan } from \"next/dist/esm/server/lib/trace/constants\";\nimport { getRevalidateReason } from \"next/dist/esm/server/instrumentation/utils\";\nimport { sendResponse } from \"next/dist/esm/server/send-response\";\nimport { fromNodeOutgoingHttpHeaders, toNodeOutgoingHttpHeaders } from \"next/dist/esm/server/web/utils\";\nimport { getCacheControlHeader } from \"next/dist/esm/server/lib/cache-control\";\nimport { INFINITE_CACHE, NEXT_CACHE_TAGS_HEADER } from \"next/dist/esm/lib/constants\";\nimport { NoFallbackError } from \"next/dist/esm/shared/lib/no-fallback-error.external\";\nimport { CachedRouteKind } from \"next/dist/esm/server/response-cache\";\nimport * as userland from \"INNER_APP_ROUTE\";\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new AppRouteRouteModule({\n    definition: {\n        kind: RouteKind.APP_ROUTE,\n        page: \"/api/affiliate/payment-intent/route\",\n        pathname: \"/api/affiliate/payment-intent\",\n        filename: \"route\",\n        bundlePath: \"\"\n    },\n    distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n    relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n    resolvedPagePath: \"[project]/src/app/api/affiliate/payment-intent/route.js\",\n    nextConfigOutput,\n    userland\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return _patchFetch({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\nexport { routeModule, workAsyncStorage, workUnitAsyncStorage, serverHooks, patchFetch,  };\nexport async function handler(req, res, ctx) {\n    if (routeModule.isDev) {\n        addRequestMeta(req, 'devRequestTimingInternalsEnd', process.hrtime.bigint());\n    }\n    let srcPage = \"/api/affiliate/payment-intent/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (process.env.TURBOPACK) {\n        srcPage = srcPage.replace(/\\/index$/, '') || '/';\n    } else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = process.env.__NEXT_MULTI_ZONE_DRAFT_MODE;\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, parsedUrl, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname, clientReferenceManifest, serverActionsManifest } = prepareResult;\n    const normalizedSrcPage = normalizeAppPath(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    const render404 = async ()=>{\n        // TODO: should route-module itself handle rendering the 404\n        if (routerServerContext == null ? void 0 : routerServerContext.render404) {\n            await routerServerContext.render404(req, res, parsedUrl, false);\n        } else {\n            res.end('This page could not be found');\n        }\n        return null;\n    };\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                if (nextConfig.experimental.adapterPath) {\n                    return await render404();\n                }\n                throw new NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isStaticGeneration = isIsr && !supportsDynamicResponse;\n    // Before rendering (which initializes component tree modules), we have to\n    // set the reference manifests to our global store so Server Action's\n    // encryption util can access to them at the top level of the page module.\n    if (serverActionsManifest && clientReferenceManifest) {\n        setManifestsSingleton({\n            page: srcPage,\n            clientReferenceManifest,\n            serverActionsManifest\n        });\n    }\n    const method = req.method || 'GET';\n    const tracer = getTracer();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            cacheComponents: Boolean(nextConfig.cacheComponents),\n            supportsDynamicResponse,\n            incrementalCache: getRequestMeta(req, 'incrementalCache'),\n            cacheLifeProfiles: nextConfig.cacheLife,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext, silenceLog)=>routeModule.onRequestError(req, error, errorContext, silenceLog, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new NodeNextRequest(req);\n    const nodeNextRes = new NodeNextResponse(res);\n    const nextReq = NextRequestAdapter.fromNodeNextRequest(nodeNextReq, signalFromNodeResponse(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${srcPage}`);\n                }\n            });\n        };\n        const isMinimalMode = Boolean(process.env.MINIMAL_MODE || getRequestMeta(req, 'minimalMode'));\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!isMinimalMode && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = toNodeOutgoingHttpHeaders(response.headers);\n                        if (cacheTags) {\n                            headers[NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await sendResponse(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        const silenceLog = false;\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: getRevalidateReason({\n                                isStaticGeneration,\n                                isOnDemandRevalidate\n                            })\n                        }, silenceLog, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil,\n                isMinimalMode\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!isMinimalMode) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = fromNodeOutgoingHttpHeaders(cacheEntry.value.headers);\n            if (!(isMinimalMode && isIsr)) {\n                headers.delete(NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', getCacheControlHeader(cacheEntry.cacheControl));\n            }\n            await sendResponse(nodeNextReq, nodeNextRes, // @ts-expect-error - Argument of type 'Buffer<ArrayBufferLike>' is not assignable to parameter of type 'BodyInit | null | undefined'.\n            new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${srcPage}`,\n                    kind: SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        if (!(err instanceof NoFallbackError)) {\n            const silenceLog = false;\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: getRevalidateReason({\n                    isStaticGeneration,\n                    isOnDemandRevalidate\n                })\n            }, silenceLog, routerServerContext);\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await sendResponse(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map\n","import { db } from \"@/lib/db\";\nimport { stripe } from \"@/lib/stripe\";\nimport { dbEscape } from \"@/lib/db-utils\";\n\nasync function getAffiliateById(affiliate_id) {\n  const [rows] = await db.query(`SELECT * FROM affiliate WHERE affiliate_id='${dbEscape(Number(affiliate_id))}' LIMIT 1`);\n  return rows?.[0] || null;\n}\n\nasync function updateAffiliate(affiliate_id, patch) {\n  const sets = Object.keys(patch)\n    .map((k) => `\\`${k}\\`='${dbEscape(patch[k])}'`)\n    .join(\", \");\n\n  await db.query(`UPDATE affiliate SET ${sets}, date_modified=NOW() WHERE affiliate_id='${dbEscape(Number(affiliate_id))}'`);\n}\n\n/**\n * Returns:\n *  - { affiliate_status:\"paid\" } if already paid/active\n *  - { affiliate_status:\"ready\", clientSecret } to show Stripe Payment Element\n */\nexport async function getSubscriptionClientSecret(affiliate_id) {\n  const affiliate = await getAffiliateById(affiliate_id);\n\n  if (!affiliate) {\n    return { affiliate_status: \"not_found\" };\n  }\n\n  // If your DB marks already paid\n  if (affiliate.payment_status !== undefined && String(affiliate.payment_status || \"\").toLowerCase() === \"paid\") {\n    return { affiliate_status: \"paid\" };\n  }\n\n  // 1) Stripe customer\n  let stripe_customer_id = affiliate.stripe_customer_id || \"\";\n\n  if (!stripe_customer_id) {\n    const customer = await stripe.customers.create({\n      email: affiliate.email,\n      name: `${affiliate.firstname} ${affiliate.lastname}`,\n      phone: affiliate.telephone,\n      metadata: { affiliate_id: String(affiliate.affiliate_id) },\n    });\n\n    stripe_customer_id = customer.id;\n\n    await updateAffiliate(affiliate.affiliate_id, {\n      stripe_customer_id,\n    });\n  }\n\n  // 2) Try reuse stored subscription if exists\n  if (affiliate.recurring_billing_id) {\n    try {\n      const sub = await stripe.subscriptions.retrieve(\n        affiliate.recurring_billing_id,\n        { expand: [\"latest_invoice.payment_intent\"] }\n      );\n\n      // If already active -> mark paid\n      if (sub.status === \"active\" || sub.status === \"trialing\") {\n        await updateAffiliate(affiliate.affiliate_id, { payment_status: \"paid\" });\n        return { affiliate_status: \"paid\" };\n      }\n\n      const pi = sub.latest_invoice?.payment_intent;\n      if (pi?.client_secret) {\n        return { affiliate_status: \"ready\", clientSecret: pi.client_secret };\n      }\n    } catch (e) {\n      // ignore and create new subscription\n    }\n  }\n\n  // 3) Create new incomplete subscription\n  const priceId = affiliate.stripe_plan_id; // must be Stripe PRICE ID\n\n  if (!priceId) {\n    return { affiliate_status: \"error\", message: \"Stripe plan/price id missing.\" };\n  }\n\n  const subscription = await stripe.subscriptions.create({\n    customer: stripe_customer_id,\n    items: [{ price: priceId }],\n    payment_behavior: \"default_incomplete\",\n    payment_settings: { \n      payment_method_types: [\"card\"],\n      save_default_payment_method: \"on_subscription\"\n    },\n    expand: [\"latest_invoice.payment_intent\"],\n    metadata: {\n      affiliate_id: String(affiliate.affiliate_id),\n      affiliate_plan_id: String(affiliate.affiliate_plan_id || \"\"),\n    },\n  });\n\n  const pi = subscription.latest_invoice?.payment_intent;\n\n  if (!pi?.client_secret) {\n    return { affiliate_status: \"error\", message: \"Could not create PaymentIntent.\" };\n  }\n\n  await updateAffiliate(affiliate.affiliate_id, {\n    stripe_customer_id: stripe_customer_id,\n    recurring_billing_id: subscription.id,\n    stripe_payment_intent_id: pi.id,\n    affiliate_status_id: 5, // Pending Payment\n  });\n\n  return { affiliate_status: \"ready\", clientSecret: pi.client_secret };\n}"],"names":[],"mappings":"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","ignoreList":[0,1,2,3,4,5,8]}